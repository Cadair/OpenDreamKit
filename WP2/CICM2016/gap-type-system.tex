\subsection{Exploring GAP types}

\subsubsection{Brief introduction to GAP types and categories.}\label{gap-types-intro}

\ednote{MP: I am not sure what I claim below about \Sage is true, it
  also irks me a bit that we seem to conflate the idea of a type system with
  the idea of organising mathematical hierarchies. Of course in \GAP
  system this is intentional, in \Sage, I don't know. In my head \Sage
  uses whatever python uses as the type system (duck typing?) and then intro-
  duces a category system on top. We should agree on a level of description
  that fits.}

While the \Sage type system is inherently object-oriented, the \GAP type
system puts more of an emphasis on \emph{operations} on and between objects.
Also a feature of the \GAP type system is that it tries to model the way
mathematicians think about their objects of study. Breuer and Linton describe
the \GAP type system in \cite{breuer-linton}, and the \GAP documentation \cite{} has
an extensive technical description.

\emph{Categories} in \GAP are a little bit like categories in category theory:
Mathematically similar objects are in the same category, so for instance
there are categories \texttt{IsSemigroup}, \texttt{IsMonoid}, and
\texttt{IsGroup}, and the fact that a monoid is a semigroup, and
a group is a monoid is encoded by subcategories. 

\emph{Representations} of objects give a way to express that for example
groups can be represented as permutation groups, matrix groups, or finitely
presented groups, or even more fine-grained there could be permutation groups
that have a more efficient representation if they act on a small numbers of
points.

An \emph{attribute} in \GAP is a value attached to a \GAP object, for
a group this can be its size,
\ednote{todo find some attributes that groups can have}.

A \emph{property} is an attribute that can only be true or false.

The values of attributes and properties can also be unknown on creation,
can be computed on demand, and their values can then be stored for later
reuse without the neeed to be recomputed.

The final concept in \GAP to be introduced here is the concept of a \emph{family}.
Families partition the set of all objects, and control how different objects can
interact. For instance all permutations in \GAP are in one family, and multiplication
is only defined between objects in the same family.
\ednote{todo: this is not entirely true, but do we care?}.

%GAP example:
%gap> IsGroup;
%<Filter "(IsMagmaWithInverses and IsAssociative)">
%gap> IsMagmaWithInverses;
%<Category "IsMagmaWithInverses">
%gap> IsAssociative;
%<Property "IsAssociative">
%gap> IsSet;
%<Property "IsSSortedList">
%gap> IsFinite;
%<Property "IsFinite">
%gap> IsSet=IsSSortedList;
%true

\ednote{NT: It could be informative to add an example of category and 
property. For example Magma and Associative. Or Set and Finite. Ideally, 
we would use the same example in the GAP and Sage section.}

\ednote{TODO (???) Compare and contrast it with the Sage type system}

\subsubsection{Tentative approaches to exporting GAP types.}\label{gap-types-export}

Encoded in the categories, representations, attributes, and properties in \GAP
there is a wealth of mathematical knowledge. \GAP allows some introspection
of this knowledge after the system is loaded.

Having a clear picture of the relations between different objects is 
very helpful to GAP developers, package authors, and users. One might 
be interested in the attributes or properties that \GAP can compute for
an object, or how it tries to compute them.

During the OpenDreamKit workshop in St Andrews in January 2016 we developed some
tools to more conveniently access mathematical knowledge encoded in \GAP's object
system and export this information in several ways:
\begin{itemize}
\item introspection inside a running \GAP session
\item export to a simple structured format such as JSON, for use with MMT
\item export as a graph for visualisation for exploration
\end{itemize}
\ednote{picture based on \url{https://github.com/OpenDreamKit/OpenDreamKit/issues/165}?}

We will make these prototype implementations available as part of the standard \GAP
distribution. We hope that they will be also enhanced by the GAP Jupyter interface developed in 
\url{https://github.com/gap-packages/jupyter-gap}.

As a side-effect of the work outlined above, we fixed a number of minor bugs in the installation
of special categories in \GAP.

The JSON output of the \GAP object system after loading a default set of packages is currently
around 11 Megabytes in size and takes many hours to import into MMT.


\ednote{MP: Actually, we have only exported the type information that is loaded when starting GAP
  with the default loaded packages, there is a lot more in the additional packages we could load}
\ednote{MP: What about consistency checks within teh GAP object system?}
\ednote{NT: Do you have anything to say about the GAP-MMT formalization? 
E.g. hints on potential ways this formalization may be written?}
\ednote{MP: I have some ideas as to how I would write an MMT formalisation, unfortunately I do not
  understand MMT well enough yet to know whether my ideas make any sense. I'll think about this a bit
  more and add my comments then}

\subsubsection{An application: consistency checker for the GAP documentation.}\label{gap-types}

One of the immediate outcomes of the development of the tools described in the
previous section is the consistency checker for the GAP documentation. 

GAP uses special format for its main manuals. It is called GAPDoc and is 
provided by the GAP package with the same name \cite{gapdoc}. Besides main 
manuals, it is adopted by 97 out of 130 packages currently redistributed 
with GAP. Using GAPDoc, one builds text, PDF and HTML versions of the manual
from a common source given in XML.

GAPDoc defines XML constructions to specify the type of the documented object 
(function, operation, attribute, property, etc.). However, due to the 
limitations of the semi-automated conversion of GAP manuals from the \TeX-based
manuals used in GAP 4.4.12 and earlier, a number of objects had their types
stated incorrectly. 

We developed the consistency checker for the GAP documentation, which extracts
type annotations from the documented GAP objects and compares them with their
actual types. It immediately reported almost 400 inconsistencies out of 3674 
manual entries. In the subsequent cleanup, we by now have eliminated about 
75\% of them. The  consistency checker will appear in the next release of
GAP 4.8.3, and will be available via \texttt{make check-manuals}.
It also performs other useful checks: for example, it produces a list of
manual sections having no examples. Thus, the new tool helps to improve
the quality of GAP documentation, and may be useful for the similar checks
of those GAP packages which use GAPDoc-based manuals.

% \url{https://github.com/gap-system/gap/pull/675}
% \url{https://github.com/gap-system/gap/pull/538}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "paper"
%%% End:
